<!--order-detail.wxml-->
<view class="container">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- è®¢å•è¯¦æƒ… -->
  <view class="order-detail" wx:if="{{!loading && order}}">
    <!-- å¤´éƒ¨å¯¼èˆª -->
    <view class="header">
      <view class="back-btn" bindtap="goBack">
        <text class="back-icon">â€¹</text>
      </view>
      <text class="header-title">è®¢å•è¯¦æƒ…</text>
      <view class="header-right"></view>
    </view>

    <!-- è®¢å•çŠ¶æ€å¡ç‰‡ -->
    <view class="status-card">
      <view class="status-info">
        <text class="status-text">{{order.statusText}}</text>
        <text class="order-no">è®¢å•å·ï¼š{{order.orderNo}}</text>
      </view>
      <view class="copy-btn" bindtap="copyOrderNo">
        <text class="copy-icon">ğŸ“‹</text>
      </view>
    </view>

    <!-- äº§å“ä¿¡æ¯ -->
    <view class="section-card">
      <view class="section-title">
        <text class="title-icon">ğŸ“¦</text>
        <text>äº§å“ä¿¡æ¯</text>
      </view>
      <view class="product-info">
        <image src="{{order.productImage}}" class="product-image" mode="aspectFill" />
        <view class="product-details">
          <text class="product-title">{{order.productTitle}}</text>
          <view class="travel-date">
            <text class="label">å‡ºè¡Œæ—¥æœŸï¼š</text>
            <text class="value">{{order.travelDate}}</text>
          </view>
          <view class="travelers">
            <text class="label">å‡ºè¡Œäººæ•°ï¼š</text>
            <text class="value">æˆäºº {{order.adultCount}} äºº</text>
            <text class="value" wx:if="{{order.childCount > 0}}">å„¿ç«¥ {{order.childCount}} äºº</text>
          </view>
        </view>
      </view>
    </view>

    <!-- è”ç³»ä¿¡æ¯ -->
    <view class="section-card">
      <view class="section-title">
        <text class="title-icon">ğŸ‘¤</text>
        <text>è”ç³»ä¿¡æ¯</text>
      </view>
      <view class="contact-info">
        <view class="info-item">
          <text class="label">è”ç³»äººï¼š</text>
          <text class="value">{{order.contactName}}</text>
        </view>
        <view class="info-item">
          <text class="label">æ‰‹æœºå·ï¼š</text>
          <text class="value">{{order.contactPhone}}</text>
        </view>
        <view class="info-item" wx:if="{{order.specialRequirements}}">
          <text class="label">ç‰¹æ®Šè¦æ±‚ï¼š</text>
          <text class="value">{{order.specialRequirements}}</text>
        </view>
      </view>
    </view>

    <!-- è´¹ç”¨æ˜ç»† -->
    <view class="section-card">
      <view class="section-title">
        <text class="title-icon">ğŸ’°</text>
        <text>è´¹ç”¨æ˜ç»†</text>
      </view>
      <view class="price-details">
        <view class="price-item">
          <text class="label">æˆäººè´¹ç”¨ï¼š</text>
          <text class="value">Â¥{{order.adultPrice}} Ã— {{order.adultCount}} äºº</text>
          <text class="subtotal">Â¥{{order.adultPrice * order.adultCount}}</text>
        </view>
        <view class="price-item" wx:if="{{order.childCount > 0}}">
          <text class="label">å„¿ç«¥è´¹ç”¨ï¼š</text>
          <text class="value">Â¥{{order.childPrice}} Ã— {{order.childCount}} äºº</text>
          <text class="subtotal">Â¥{{order.childPrice * order.childCount}}</text>
        </view>
        <view class="price-divider"></view>
        <view class="price-total">
          <text class="label">è®¢å•æ€»ä»·ï¼š</text>
          <text class="total-value">Â¥{{order.totalPrice}}</text>
        </view>
      </view>
    </view>

    <!-- è®¢å•æ—¶é—´ -->
    <view class="section-card">
      <view class="section-title">
        <text class="title-icon">â°</text>
        <text>è®¢å•æ—¶é—´</text>
      </view>
      <view class="time-info">
        <view class="time-item">
          <text class="label">åˆ›å»ºæ—¶é—´ï¼š</text>
          <text class="value">{{order.createTime}}</text>
        </view>
        <view class="time-item" wx:if="{{order.paymentTime}}">
          <text class="label">æ”¯ä»˜æ—¶é—´ï¼š</text>
          <text class="value">{{order.paymentTime}}</text>
        </view>
        <view class="time-item" wx:if="{{order.updateTime}}">
          <text class="label">æ›´æ–°æ—¶é—´ï¼š</text>
          <text class="value">{{order.updateTime}}</text>
        </view>
      </view>
    </view>

    <!-- æ“ä½œæŒ‰é’® -->
    <view class="action-buttons" wx:if="{{order.status === 'paid'}}">
      <button class="btn-refund" bindtap="requestRefund">
        <text class="btn-icon">ğŸ’°</text>
        <text>ç”³è¯·é€€æ¬¾</text>
      </button>
    </view>
  </view>

  <!-- é”™è¯¯çŠ¶æ€ -->
  <view class="error-container" wx:if="{{!loading && !order}}">
    <text class="error-icon">âŒ</text>
    <text class="error-text">è®¢å•ä¸å­˜åœ¨æˆ–å·²è¢«åˆ é™¤</text>
    <button class="btn-primary" bindtap="goBack">è¿”å›</button>
  </view>
</view>