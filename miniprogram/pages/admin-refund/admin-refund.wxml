<!--miniprogram/pages/admin-refund/admin-refund.wxml-->
<view class="container">
  <!-- å¤´éƒ¨ -->
  <view class="header">
    <view class="title">é€€æ¬¾ç®¡ç†</view>
    <view class="refresh-btn" bindtap="onRefresh">
      <text class="icon">ğŸ”„</text>
    </view>
  </view>

  <!-- çŠ¶æ€ç­›é€‰ -->
  <view class="filter-section">
    <picker bindchange="onStatusChange" value="{{statusFilter}}" range-key="label" range="{{statusOptions}}">
      <view class="filter-picker">
        <text>çŠ¶æ€ç­›é€‰ï¼š{{statusOptions[statusFilter] || 'å…¨éƒ¨'}}</text>
        <text class="arrow">â–¼</text>
      </view>
    </picker>
  </view>

  <!-- é€€æ¬¾åˆ—è¡¨ -->
  <view class="refund-list">
    <view wx:if="{{loading}}" class="loading">
      <text>åŠ è½½ä¸­...</text>
    </view>

    <view wx:elif="{{refundList.length === 0}}" class="empty">
      <text class="empty-icon">ğŸ“‹</text>
      <text class="empty-text">æš‚æ— é€€æ¬¾ç”³è¯·</text>
    </view>

    <view wx:else>
      <view class="refund-item" wx:for="{{refundList}}" wx:key="_id">
        <view class="refund-header">
          <view class="refund-id">é€€æ¬¾å•å·ï¼š{{item.outRefundNo}}</view>
          <view class="refund-status status-{{item.status}}">
            <text wx:if="{{item.status === 'pending'}}">å¾…å®¡æ ¸</text>
            <text wx:elif="{{item.status === 'approved'}}">å·²é€šè¿‡</text>
            <text wx:elif="{{item.status === 'rejected'}}">å·²æ‹’ç»</text>
            <text wx:elif="{{item.status === 'completed'}}">å·²å®Œæˆ</text>
            <text wx:else>{{item.status}}</text>
          </view>
        </view>

        <view class="refund-info">
          <view class="info-row">
            <text class="label">é€€æ¬¾é‡‘é¢ï¼š</text>
            <text class="amount">Â¥{{item.amount}}</text>
          </view>
          <view class="info-row">
            <text class="label">ç”³è¯·æ—¶é—´ï¼š</text>
            <text class="time">{{item.applyTime}}</text>
          </view>
          <view class="info-row">
            <text class="label">é€€æ¬¾åŸå› ï¼š</text>
            <text class="reason">{{item.reason}}</text>
          </view>
          <view wx:if="{{item.reviewNote}}" class="info-row">
            <text class="label">å®¡æ ¸å¤‡æ³¨ï¼š</text>
            <text class="note">{{item.reviewNote}}</text>
          </view>
        </view>

        <view class="refund-actions">
          <button wx:if="{{item.status === 'pending'}}" 
                  class="btn-review" 
                  bindtap="reviewRefund" 
                  data-id="{{item._id}}">
            å®¡æ ¸
          </button>
          <button class="btn-detail" 
                  bindtap="viewDetail" 
                  data-id="{{item._id}}">
            è¯¦æƒ…
          </button>
        </view>
      </view>
    </view>
  </view>
</view>
